<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RevAIse - YouTube to Slides & Reading Level Converter</title>
  <!-- Bootstrap CSS via CDN for improved styling -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-9ndCyUa6mY5v/giwlvNBDppJZ3fXq9p3LQl0oK1MZtwt6S3mB1p1HNKhXQqWl5Q"
    crossorigin="anonymous"
  />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="/">RevAIse</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-overlay"></div>
    <div class="hero-content text-center text-white">
      <div class="container">
        <h1 class="display-4">Convert YouTube Videos to Slides</h1>
        <p class="lead">Transform any video into an engaging presentation.</p>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="container my-5">
    <!-- Existing YouTube Transcript Form -->
    <div class="card shadow mb-5">
      <div class="card-body">
        <h2 class="card-title text-center mb-4">Generate Slides from YouTube</h2>
        <form id="summaryForm">
          <div class="mb-3">
            <input
              type="text"
              class="form-control form-control-lg"
              name="youtube_url"
              placeholder="Enter YouTube URL"
              required
            />
          </div>
          <div class="d-grid">
            <button type="submit" class="btn btn-primary btn-lg">Generate Slides</button>
          </div>
        </form>
        <!-- Error Message Container -->
        <p id="errorMessage" class="text-danger mt-3"></p>
      </div>
    </div>

    <!-- New Reading Level Converter Form -->
    <div class="card shadow">
      <div class="card-body">
        <h2 class="card-title text-center mb-4">Adapt Text for Reading Level</h2>
        <form id="convertForm">
          <div class="mb-3">
            <textarea
              class="form-control"
              name="input_text"
              placeholder="Paste your text here..."
              rows="6"
              required
            ></textarea>
          </div>
          <div class="mb-3">
            <label for="yearGroup" class="form-label">Select Year Group:</label>
            <select class="form-select" name="year_group" id="yearGroup" required>
              <option value="Year 1">Year 1</option>
              <option value="Year 2">Year 2</option>
              <option value="Year 3">Year 3</option>
              <option value="Year 4">Year 4</option>
              <option value="Year 5">Year 5</option>
              <option value="Year 6">Year 6</option>
              <!-- Add or modify options as needed -->
            </select>
          </div>
          <div class="d-grid">
            <button type="submit" class="btn btn-success btn-lg">Convert</button>
          </div>
        </form>
        <!-- Container for the converted output -->
        <div id="convertedOutput" class="mt-3"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white py-4">
    <div class="container text-center">
      &copy; {{ current_year if current_year else '2025' }} RevAIse. All rights reserved.
    </div>
  </footer>

  <!-- Bootstrap Bundle JS (includes Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeo7FjK9nY7Nx2D5T1N8E+4TpsWe7mN9ZCk5mV2QyZcVJ4zN"
    crossorigin="anonymous"
  ></script>

  <!-- JavaScript code for form handling -->
  <script>
    // YouTube transcript generation form
    document.getElementById("summaryForm").addEventListener("submit", function (event) {
      event.preventDefault();
      document.getElementById("errorMessage").innerText = "";
      const youtubeUrl = event.target.youtube_url.value;
      fetch("/generate_summary", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ youtube_url: youtubeUrl }),
      })
        .then((response) => {
          if (!response.ok) {
            return response.json().then((errData) => {
              throw new Error(errData.error || "Network response was not OK");
            });
          }
          return response.json();
        })
        .then((data) => {
          console.log("Data received:", data);
          // Handle transcript/slide generation response...
        })
        .catch((error) => {
          document.getElementById("errorMessage").innerText = "Error: " + error.message;
        });
    });

    // Reading level converter form
    document.getElementById("convertForm").addEventListener("submit", function (event) {
      event.preventDefault();
      // Clear any previous output
      document.getElementById("convertedOutput").innerHTML = "";
      const inputText = event.target.input_text.value;
      const yearGroup = event.target.year_group.value;
      // Send the text and target year group to the /convert_text endpoint
      fetch("/convert_text", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ input_text: inputText, year_group: yearGroup }),
      })
        .then((response) => {
          if (!response.ok) {
            return response.json().then((errData) => {
              throw new Error(errData.error || "Conversion failed");
            });
          }
          return response.json();
        })
        .then((data) => {
          // Display the converted text
          document.getElementById("convertedOutput").innerHTML =
            "<h4>Converted Text:</h4><p>" + data.converted_text + "</p>";
        })
        .catch((error) => {
          document.getElementById("convertedOutput").innerHTML =
            "<p class='text-danger'>Error: " + error.message + "</p>";
        });
    });
  </script>
</body>
</html>
